# ä¸‹ä¸€æ­¥åšä»€ä¹ˆ

## ğŸ‰ æ­å–œï¼GitHub Actions è¿è¡ŒæˆåŠŸï¼

ä½ çš„ä»“åº“ç°åœ¨æœ‰ï¼š
- âœ… å®Œæ•´çš„æœºå™¨äººä»£ç 
- âœ… è‡ªåŠ¨æ›´æ–°çš„ Apifox æ–‡æ¡£
- âœ… GitHub Actions è‡ªåŠ¨è¿è¡Œ

---

## ğŸ“‹ ä¸‹ä¸€æ­¥è¡ŒåŠ¨æ¸…å•

### ç¬¬ 3 æ­¥ï¼šé…ç½®æœ¬åœ°ç¯å¢ƒï¼ˆç°åœ¨å¼€å§‹ï¼‰

#### 3.1 å®‰è£… Python ä¾èµ–

```bash
cd D:\document-all\TechnicalSupport\knowledge-base-bot
pip install -r requirements.txt
```

#### 3.2 é…ç½®ç¯å¢ƒå˜é‡

```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp .env.example .env

# ç¼–è¾‘ .env æ–‡ä»¶
```

**å¿…éœ€é…ç½®**ï¼š
```env
# LLM APIï¼ˆé€‰æ‹©ä¸€ä¸ªï¼‰
LLM_API_KEY=your-api-key-here

# æ¨èä½¿ç”¨ï¼š
# - Claude: https://console.anthropic.com/
# - DeepSeek: https://platform.deepseek.com/
```

**å¯é€‰é…ç½®**ï¼ˆæµ‹è¯•é˜¶æ®µä¸éœ€è¦ï¼‰ï¼š
```env
# é£ä¹¦é…ç½®ï¼ˆåé¢é…ç½®ï¼‰
FEISHU_APP_ID=
FEISHU_APP_SECRET=
```

---

### ç¬¬ 4 æ­¥ï¼šæ„å»ºçŸ¥è¯†åº“

#### 4.1 æ‹‰å–æœ€æ–°æ–‡æ¡£

```bash
git pull origin main
```

#### 4.2 æ„å»ºå‘é‡æ•°æ®åº“

```bash
python src/rag/knowledge_base.py
```

è¿™ä¼šï¼š
- è¯»å– `data/documents/apifox/` ä¸­çš„æ–‡æ¡£
- æ„å»ºå‘é‡æ•°æ®åº“
- ä¿å­˜åˆ° `data/vectordb/`

---

### ç¬¬ 5 æ­¥ï¼šæœ¬åœ°æµ‹è¯•

#### 5.1 æµ‹è¯•çŸ¥è¯†åº“æ£€ç´¢

```bash
python -c "
import asyncio
from src.rag.knowledge_base import KnowledgeBase
from src.utils.config_loader import load_config

async def test():
    config = load_config()
    kb = KnowledgeBase(config)
    await kb.initialize()

    results = await kb.search('å¦‚ä½•å‘é€æ¥å£è¯·æ±‚')
    print(f'æ‰¾åˆ° {len(results)} ä¸ªç›¸å…³æ–‡æ¡£')
    for i, doc in enumerate(results, 1):
        print(f'\næ–‡æ¡£ {i}:')
        print(doc.page_content[:200])

asyncio.run(test())
"
```

#### 5.2 æµ‹è¯•é—®é¢˜åˆ†ç±»

```bash
python -c "
import asyncio
from src.classifiers.question_classifier import QuestionClassifier
from src.utils.config_loader import load_config

async def test():
    config = load_config()
    classifier = QuestionClassifier(config)

    result = await classifier.classify(
        question='æ¥å£æµ‹è¯•å¤±è´¥äº†æ€ä¹ˆåŠ',
        context='æµ‹è¯•ç›¸å…³æ–‡æ¡£',
        additional_info={'version': '2.5.0'}
    )

    print(f'é—®é¢˜ç±»å‹: {result[\"type\"]}')
    print(f'ç½®ä¿¡åº¦: {result[\"confidence\"]}')
    print(f'ç†ç”±: {result[\"reason\"]}')

asyncio.run(test())
"
```

---

### ç¬¬ 6 æ­¥ï¼šé…ç½®é£ä¹¦åº”ç”¨ï¼ˆå¯é€‰ï¼‰

å¦‚æœä½ æƒ³ä½¿ç”¨é£ä¹¦æœºå™¨äººï¼š

#### 6.1 åˆ›å»ºé£ä¹¦åº”ç”¨

1. è®¿é—® https://open.feishu.cn/app
2. åˆ›å»ºä¼ä¸šè‡ªå»ºåº”ç”¨
3. å¼€å¯æœºå™¨äººæƒé™
4. è·å– App ID å’Œ App Secret

#### 6.2 åˆ›å»ºå¤šç»´è¡¨æ ¼

åˆ›å»ºè¡¨ç»“æ„ï¼ˆå‚è€ƒ `docs/å‰ç½®å‡†å¤‡.md`ï¼‰

#### 6.3 é…ç½® .env

```env
FEISHU_APP_ID=cli_xxxxxxxxxxxxx
FEISHU_APP_SECRET=xxxxxxxxxxxxxx
```

---

### ç¬¬ 7 æ­¥ï¼šå¯åŠ¨æœºå™¨äºº

#### 7.1 æœ¬åœ°è¿è¡Œ

```bash
python src/bots/main.py
```

æœåŠ¡ä¼šåœ¨ http://localhost:8000 è¿è¡Œ

#### 7.2 ä½¿ç”¨ ngrok æµ‹è¯•ï¼ˆæœ¬åœ°ï¼‰

```bash
# å®‰è£… ngrok
# ä¸‹è½½: https://ngrok.com/download

# å¯åŠ¨éš§é“
ngrok http 8000

# å¤åˆ¶ç”Ÿæˆçš„ URL åˆ°é£ä¹¦ Webhook
```

---

## ğŸ¯ å¿«é€Ÿå¼€å§‹ï¼ˆæœ€ç®€ç‰ˆæœ¬ï¼‰

å¦‚æœåªæƒ³å¿«é€Ÿæµ‹è¯•ï¼Œæœ€å°‘éœ€è¦ï¼š

### 1. å®‰è£…ä¾èµ–
```bash
pip install anthropic chromadb langchain
```

### 2. è·å– API Key
- è®¿é—® https://console.anthropic.com/
- åˆ›å»º API Key

### 3. æµ‹è¯•çŸ¥è¯†åº“
```bash
python src/rag/knowledge_base.py
```

### 4. æµ‹è¯•æ£€ç´¢
```bash
python -c "
import asyncio
from src.rag.knowledge_base import KnowledgeBase

async def test():
    kb = KnowledgeBase(None)
    await kb.initialize()
    results = await kb.search('æµ‹è¯•')
    for doc in results:
        print(doc.page_content)

asyncio.run(test())
"
```

---

## ğŸ“Š æ¨èçš„å­¦ä¹ è·¯å¾„

### è·¯å¾„ Aï¼šå¿«é€Ÿä½“éªŒï¼ˆ30åˆ†é’Ÿï¼‰
1. å®‰è£…ä¾èµ–
2. é…ç½® LLM API Key
3. æµ‹è¯•çŸ¥è¯†åº“æ£€ç´¢
4. æµ‹è¯•é—®é¢˜åˆ†ç±»

### è·¯å¾„ Bï¼šå®Œæ•´åŠŸèƒ½ï¼ˆ2å°æ—¶ï¼‰
1. å¿«é€Ÿä½“éªŒçš„æ‰€æœ‰æ­¥éª¤
2. é…ç½®é£ä¹¦åº”ç”¨
3. æµ‹è¯•æœºå™¨äººå®Œæ•´æµç¨‹
4. åœ¨æµ‹è¯•ç¾¤ä¸­è¯•ç”¨

### è·¯å¾„ Cï¼šç”Ÿäº§éƒ¨ç½²ï¼ˆ1å¤©ï¼‰
1. å®Œæ•´åŠŸèƒ½çš„æ‰€æœ‰æ­¥éª¤
2. éƒ¨ç½²åˆ°äº‘æœåŠ¡å™¨
3. é…ç½®åŸŸåå’Œ SSL
4. æ¨å¹¿åˆ°æ‰€æœ‰ç”¨æˆ·ç¾¤

---

## ğŸ†˜ é‡åˆ°é—®é¢˜ï¼Ÿ

### å¸¸è§é—®é¢˜

**Q1: ä¾èµ–å®‰è£…å¤±è´¥ï¼Ÿ**
```bash
# å•ç‹¬å®‰è£…æ ¸å¿ƒä¾èµ–
pip install anthropic chromadb
```

**Q2: çŸ¥è¯†åº“æ„å»ºå¤±è´¥ï¼Ÿ**
```bash
# æ£€æŸ¥æ–‡æ¡£æ˜¯å¦å­˜åœ¨
ls data/documents/apifox

# å¦‚æœä¸ºç©ºï¼Œå…ˆæ‹‰å–æœ€æ–°ä»£ç 
git pull origin main
```

**Q3: LLM API è°ƒç”¨å¤±è´¥ï¼Ÿ**
- æ£€æŸ¥ API Key æ˜¯å¦æ­£ç¡®
- æ£€æŸ¥ç½‘ç»œè¿æ¥
- æŸ¥çœ‹æ—¥å¿— `logs/bot.log`

**Q4: æƒ³è·³è¿‡æŸäº›æ­¥éª¤ï¼Ÿ**
- å¯ä»¥è·³è¿‡é£ä¹¦é…ç½®ï¼Œå…ˆæœ¬åœ°æµ‹è¯•
- å¯ä»¥è·³è¿‡éƒ¨ç½²ï¼Œåªåœ¨æœ¬åœ°è¿è¡Œ
- å¯ä»¥è·³è¿‡åˆ†ç±»å™¨ï¼Œåªç”¨çŸ¥è¯†åº“æ£€ç´¢

---

## ğŸ’¡ ä¸‹ä¸€æ­¥å»ºè®®

**æˆ‘å»ºè®®ä½ ç°åœ¨**ï¼š

1. **è·å– LLM API Key**ï¼ˆæœ€é‡è¦ï¼Œ5åˆ†é’Ÿï¼‰
   - https://console.anthropic.com/
   - æˆ– https://platform.deepseek.com/

2. **é…ç½® .env æ–‡ä»¶**ï¼ˆ2åˆ†é’Ÿï¼‰
   ```bash
   cp .env.example .env
   # ç¼–è¾‘å¡«å†™ API Key
   ```

3. **æµ‹è¯•çŸ¥è¯†åº“**ï¼ˆ5åˆ†é’Ÿï¼‰
   ```bash
   python src/rag/knowledge_base.py
   ```

**è¿™æ ·å°±èƒ½çœ‹åˆ°çŸ¥è¯†åº“æ˜¯å¦æ­£å¸¸å·¥ä½œäº†ï¼**

---

å‡†å¤‡å¥½äº†å‘Šè¯‰æˆ‘ï¼Œæˆ‘å¸®ä½ ç»§ç»­ä¸‹ä¸€æ­¥ï¼ğŸš€
